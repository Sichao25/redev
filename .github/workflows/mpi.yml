name: mpi test
on:
  push:
    branches: [ main ]

jobs:
  mpi-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Install MPICH
        run: |
          sudo apt-get update
          sudo apt-get install -y mpich libmpich-dev hotfix-apt-ubuntu-noble-mpich
      # - name: Setup MPI
      #   uses: mpi4py/setup-mpi@v1
      #   with:
      #     mpi: mpich

      - name: Build MPI program
        run: |
          mpicc test_mpi.c -o test_mpi
      - name: Run MPI
        run: |
          mpirun -n 2 ./test_mpi